datasource db {
  provider = "postgresql"
  url      = env("API_DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Job {
  id               String           @id
  displayId        String           @unique
  title            String
  prompt           String
  status           String
  createdAt        DateTime
  prodJobHistories ProdJobHistory[]
  ChatLog          ChatLog          @relation(fields: [chatLogId], references: [id])
  chatLogId        String
}

model ProdJobHistory {
  id        String   @id
  Job       Job      @relation(fields: [jobId], references: [id])
  jobId     String
  createdAt DateTime
}

model ChatLog {
  id               String   @id
  modelId          String
  status           String
  s3Key            String?
  inputTokenCount  Int?
  outputTokenCount Int?
  createdAt        DateTime
  jobs             Job[]
}

model Bubble {
  id        String   @id
  type      String
  index     Int
  content   String
  createdAt DateTime
  App       App      @relation(fields: [appId], references: [id])
  appId     String
}

model App {
  id              String   @id
  userId          String
  index           Int
  name            String
  status          String
  environmentId   String?
  projectId       String?
  serviceId       String?
  createdAt       DateTime
  statusUpdatedAt DateTime
  bubbles         Bubble[]
}
